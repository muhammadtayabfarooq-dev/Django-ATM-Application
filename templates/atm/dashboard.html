{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}
{% block content %}
<div class="card">
    <h2>Your Accounts</h2>
    <form action="{% url 'create_account' %}" method="post" style="margin-top:10px;">
        {% csrf_token %}
        {{ account_form.name.label_tag }}
        {{ account_form.name }}
        <button class="btn" type="submit">Create Account</button>
    </form>
    <div class="grid" style="margin-top:14px;">
        {% for account in accounts %}
            <div class="card">
                <div class="muted">{{ account.account_number }}</div>
                <h3 style="margin:8px 0 6px;">{{ account.name }}</h3>
                <div style="font-size:1.3rem; font-weight:700;">${{ account.balance }}</div>
                <div class="muted">Opened {{ account.created_at|date:"M d, Y" }}</div>
                <div style="margin-top:10px;">
                    <a class="btn" href="{% url 'account_detail' account.pk %}">View</a>
                </div>
            </div>
        {% empty %}
            <p class="muted">No accounts yet. Create one to begin.</p>
        {% endfor %}
    </div>
</div>

<div class="card">
    <h2>Recent Transactions</h2>
    <table>
        <thead>
            <tr>
                <th>Type</th>
                <th>Account</th>
                <th>Amount</th>
                <th>Balance After</th>
                <th>When</th>
            </tr>
        </thead>
        <tbody>
        {% for txn in recent_transactions %}
            <tr>
                <td>{{ txn.get_txn_type_display }}</td>
                <td>{{ txn.account.account_number }}</td>
                <td>${{ txn.amount }}</td>
                <td>${{ txn.balance_after }}</td>
                <td class="muted">{{ txn.created_at|date:"M d, H:i" }}</td>
            </tr>
        {% empty %}
            <tr><td colspan="5" class="muted">No activity yet.</td></tr>
        {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
